{"code":"(window.webpackJsonpCaskCommon=window.webpackJsonpCaskCommon||[]).push([[0],{2532:function(e,t,a){var n=a(641),r=a(257),i=a(498);e.exports=function(e){return\"string\"==typeof e||!r(e)&&i(e)&&\"[object String]\"==n(e)}},2647:function(e,t,a){\"use strict\";a.r(t),a.d(t,\"default\",(function(){return U}));var n=a(1),r=a.n(n),i=a(0),o=a.n(i),l=a(253),s=a(393),c=a(284),u=a(17),m=a(28),p=a(8),f=a(3),d=a(2),b=a.n(d),g=a(4),h=a.n(g),y=a(43),v=a(144),E=a(854),w=a(2532),k=a.n(w),N=a(14),O=a(32);function C(e){return(C=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function P(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=I(e);if(t){var r=I(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return T(this,a)}}function T(e,t){return!t||\"object\"!==C(t)&&\"function\"!=typeof t?function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=\"features.DataPrep.TopPanel\",U=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(i,e);var t,a,n,r=S(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,i),(t=r.call(this,e)).state={loading:!0,batchUrl:null,realtimeUrl:null,error:null,workspaceId:null,realtimeConfig:null,batchConfig:null},t}return t=i,(a=[{key:\"componentWillMount\",value:function(){this.generateLinks()}},{key:\"generateLinks\",value:function(){var e=this,t=u.a.getState().dataprep.workspaceId,a=Object(p.getCurrentNamespace)();Object(E.a)().subscribe((function(n){var r;r=n.realtimeConfig?window.getHydratorUrl({stateName:\"hydrator.create\",stateParams:{namespace:a,workspaceId:t,artifactType:\"cdap-data-streams\"}}):null;var i=window.getHydratorUrl({stateName:\"hydrator.create\",stateParams:{namespace:a,workspaceId:t,artifactType:\"cdap-data-pipeline\"}});e.setState({loading:!1,realtimeUrl:r,batchUrl:i,workspaceId:t,realtimeConfig:n.realtimeConfig,batchConfig:n.batchConfig})}),(function(t){var a=function(e){if(-1!==e.indexOf(\"invalid field name\")){var t=e.split(\"field name: \"),a=Object(f.objectQuery)(t,1)||e;return{message:b.a.translate(\"\".concat(R,\".invalidFieldNameMessage\"),{fieldName:a}),remedies:\"\".concat(b.a.translate(\"\".concat(R,\".invalidFieldNameRemedies1\")))}}return{message:e}}(t),n=a.message,r=a.remedies,i=void 0===r?null:r;i?e.setState({error:{message:n,remedies:i},loading:!1}):e.setState({error:t,loading:!1})}))}},{key:\"applyDirective\",value:function(e){var t=this;Object(y.a)([e]).subscribe((function(){t.setState({error:null,loading:!0,schema:[]},(function(){t.generateLinks()}))}),(function(e){console.log(\"Error\",e),u.a.dispatch({type:m.a.setError,payload:{message:e.message||e.response.message}})}))}},{key:\"renderInvalidFieldError\",value:function(){return o.a.createElement(\"div\",{className:\"message\"},o.a.createElement(\"pre\",null,o.a.createElement(\"div\",{className:\"remedy-message\"},Object(f.objectQuery)(this.state,\"error\",\"remedies\")?this.state.error.remedies:null),o.a.createElement(\"span\",null,b.a.translate(\"\".concat(R,\".invalidFieldNameRemedies2\")),o.a.createElement(\"span\",{className:\"btn-link\",onClick:this.applyDirective.bind(this,\"cleanse-column-names\")},b.a.translate(\"\".concat(R,\".cleanseLinkLabel\"))),b.a.translate(\"\".concat(R,\".invalidFieldNameRemedies3\")))))}},{key:\"render\",value:function(){var e,t=this,a=!1===O.Theme.showRealtimePipeline;if(this.state.loading)e=o.a.createElement(\"div\",{className:\"loading-container\"},o.a.createElement(\"h4\",{className:\"text-center\"},o.a.createElement(\"span\",{className:\"fa fa-spin fa-spinner\"})));else{var n,r=u.a.getState().dataprep.workspaceInfo.properties.connection;this.state.realtimeUrl||(n=b.a.translate(\"\".concat(R,\".realtimeDisabledTooltip\"),{type:b.a.translate(\"\".concat(R,\".\").concat(r))}));var i=a?null:this.state.realtimeUrl;e=o.a.createElement(\"div\",null,o.a.createElement(\"div\",{className:\"message\"},b.a.translate(\"\".concat(R,\".addToPipelineModal.title\"))),o.a.createElement(\"div\",{className:\"action-buttons\"},o.a.createElement(\"a\",{href:this.state.error?null:this.state.batchUrl,className:h()(\"btn btn-secondary\",{inactive:this.state.error}),onClick:function(){t.state.error||window.localStorage.setItem(t.state.workspaceId,JSON.stringify(t.state.batchConfig))}.bind(this)},o.a.createElement(\"i\",{className:\"fa icon-ETLBatch\"}),o.a.createElement(\"span\",null,b.a.translate(\"\".concat(R,\".addToPipelineModal.batchPipelineBtn\")))),o.a.createElement(\"a\",{href:i,className:h()(\"btn btn-secondary\",{inactive:!this.state.realtimeUrl||this.state.error||a}),onClick:function(){t.state.realtimeUrl&&!a&&window.localStorage.setItem(t.state.workspaceId,JSON.stringify(t.state.realtimeConfig))}.bind(this),title:n},o.a.createElement(\"i\",{className:\"fa icon-sparkstreaming\"}),o.a.createElement(\"span\",null,b.a.translate(\"\".concat(R,\".addToPipelineModal.realtimePipelineBtn\"))))))}var m=!Object(f.objectQuery)(this.state,\"error\",\"remedies\");return o.a.createElement(l.a,{isOpen:!0,toggle:this.props.toggle,size:\"lg\",zIndex:1061,className:\"add-to-pipeline-dataprep-modal cdap-modal\"},o.a.createElement(s.a,null,o.a.createElement(\"span\",null,b.a.translate(\"\".concat(R,\".addToPipelineBtnLabel\"))),o.a.createElement(\"div\",{className:\"close-section float-right\",onClick:this.props.toggle},o.a.createElement(\"span\",{className:\"fa fa-times\"}))),o.a.createElement(c.a,null,m?e:this.renderInvalidFieldError()),o.a.createElement(N.a,{condition:this.state.error},o.a.createElement(v.b,{type:\"DANGER\",message:b.a.translate(\"\".concat(R,\".addToPipelineModal.errorTitle\")),extendedMessage:k()(this.state.error)?this.state.error:null})))}}])&&P(t.prototype,a),n&&P(t,n),i}(i.Component);U.propTypes={toggle:r.a.func}}}]);","extractedComments":[]}