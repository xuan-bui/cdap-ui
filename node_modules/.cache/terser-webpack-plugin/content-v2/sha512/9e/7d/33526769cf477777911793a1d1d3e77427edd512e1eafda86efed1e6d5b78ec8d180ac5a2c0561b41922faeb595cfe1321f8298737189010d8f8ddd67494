{"code":"(window.webpackJsonpCaskCommon=window.webpackJsonpCaskCommon||[]).push([[3],{2646:function(e,t,a){\"use strict\";a.r(t),a.d(t,\"default\",(function(){return T}));var n=a(1),r=a.n(n),s=a(0),o=a.n(s),i=a(253),l=a(393),c=a(283),u=a(82),m=a(17),f=a(565),p=a.n(f),d=a(8),h=a(4),b=a(2),y=a.n(b),g=a(43),v=a(28),E=a(144),w=a(14),O=a(578),S=a(391);function k(e){return(k=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function N(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=D(e);if(t){var r=D(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return R(this,a)}}function R(e,t){return!t||\"object\"!==k(t)&&\"function\"!=typeof t?C(e):t}function C(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(s,e);var t,a,n,r=j(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,s),(t=r.call(this,e)).state={loading:!0,error:null,schema:[]},t.download=t.download.bind(C(t)),t}return t=s,(a=[{key:\"componentDidMount\",value:function(){this.getSchema()}},{key:\"getSchema\",value:function(){var e=this,t=m.a.getState().dataprep.workspaceId,a={context:Object(d.getCurrentNamespace)(),workspaceId:t};u.a.getSpecification(a).subscribe((function(t){var a=t.wrangler;try{O.default.parse(a.schema)}catch(t){var n=function(e){if(-1!==e.message.indexOf(\"invalid field name\")){var t=e.message.split(\"field name: \"),a=Object(h.objectQuery)(t,1)||e.message;return{message:y.a.translate(\"features.DataPrep.TopPanel.invalidFieldNameMessage\",{fieldName:a}),remedies:\"\".concat(y.a.translate(\"features.DataPrep.TopPanel.invalidFieldNameRemedies1\"))}}return{message:e.message}}(t),r=n.remedies,s=n.error;return e.setState({loading:!1,error:s,remedies:r})}e.setState({loading:!1,schema:{name:\"etlSchemaBody\",schema:a.schema}})}),(function(t){e.setState({loading:!1,error:Object(h.objectQuery)(t,\"response\",\"message\")||y.a.translate(\"features.DataPrep.TopPanel.SchemaModal.defaultErrorMessage\")})}))}},{key:\"applyDirective\",value:function(e){var t=this;Object(g.a)([e]).subscribe((function(){t.setState({error:null,loading:!0,schema:[]}),setTimeout((function(){t.getSchema()}))}),(function(e){console.log(\"Error\",e),m.a.dispatch({type:v.a.setError,payload:{message:e.message||e.response.message}})}))}},{key:\"download\",value:function(){var e=m.a.getState().dataprep.workspaceId,t=\"\".concat(e,\"-schema.json\");p()(JSON.stringify([this.state.schema],null,4),t)}},{key:\"render\",value:function(){var e;return e=this.state.loading?o.a.createElement(\"div\",{className:\"text-center\"},o.a.createElement(\"h4\",null,o.a.createElement(\"span\",{className:\"fa fa-spin fa-spinner\"}))):this.state.error?o.a.createElement(\"div\",null,o.a.createElement(\"div\",{className:\"remedy-message\"},Object(h.objectQuery)(this.state,\"error\",\"remedies\")?this.state.error.remedies:null),o.a.createElement(\"span\",null,y.a.translate(\"features.DataPrep.TopPanel.invalidFieldNameRemedies2\"),o.a.createElement(\"span\",{className:\"btn-link\",onClick:this.applyDirective.bind(this,\"cleanse-column-names\")},y.a.translate(\"features.DataPrep.TopPanel.cleanseLinkLabel\")),y.a.translate(\"features.DataPrep.TopPanel.invalidFieldNameRemedies3\"))):o.a.createElement(\"fieldset\",{disabled:!0},o.a.createElement(S.SchemaEditor,{visibleRows:10,schema:this.state.schema,disabled:!0})),o.a.createElement(i.a,{isOpen:!0,toggle:this.props.toggle,size:\"lg\",zIndex:\"1061\",className:\"dataprep-schema-modal cdap-modal\"},o.a.createElement(l.a,null,o.a.createElement(\"span\",null,\"Schema\"),o.a.createElement(\"div\",{className:\"close-section float-right\"},o.a.createElement(\"button\",{disabled:this.state.error?\"disabled\":null,className:\"btn btn-link\",onClick:this.download},o.a.createElement(\"span\",{className:\"fa fa-download\"})),o.a.createElement(\"span\",{className:\"fa fa-times\",onClick:this.props.toggle}))),o.a.createElement(c.a,null,e),o.a.createElement(w.a,{condition:this.state.error},o.a.createElement(E.b,{type:\"DANGER\",message:Object(h.isNilOrEmpty)(this.state.error)?this.state.error:this.state.error.message,extendedMessage:this.state.remedies})))}}])&&N(t.prototype,a),n&&N(t,n),s}(s.Component);T.propTypes={toggle:r.a.func}}}]);","extractedComments":[]}