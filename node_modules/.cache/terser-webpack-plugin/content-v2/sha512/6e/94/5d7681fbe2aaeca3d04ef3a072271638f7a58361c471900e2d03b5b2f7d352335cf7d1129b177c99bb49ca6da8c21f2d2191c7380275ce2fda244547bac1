{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1773:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return p}));var r=a(8),n=a(60),o=a(9),i=a(27),s=a(122);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){u(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(){var e=o.a.getState().dataprep.workspaceId,t={context:Object(r.d)(),workspaceId:e};return n.a.getSpecification(t).map((function(e){var t={name:\"cdap-data-pipeline\",version:s.a.getState().version,scope:i.h.SYSTEM},a=l({},t,{name:\"cdap-data-streams\"}),r=[],n=[],o=[],c=[],u=m(e.wrangler);r.push(u),n.push(u);var p=u.name;e.sources.forEach((function(e){var t=e.plugin.type;if(\"batchsource\"===t||\"streamingsource\"===t){var a=m(e),i={from:a.name,to:p};return\"batchsource\"===t?(o.push(i),void r.push(a)):\"streamingsource\"===t?(c.push(i),void n.push(a)):void 0}}));var f={batchConfig:{artifact:t,config:{stages:r,connections:o,resources:{memoryMB:i.c.resources.memoryMB,virtualCores:i.c.resources.virtualCores},driverResources:{memoryMB:i.c.resources.memoryMB,virtualCores:i.c.resources.virtualCores}}}};return n.length>1&&(f.realtimeConfig={artifact:a,config:{stages:n,connections:c,resources:{memoryMB:i.c.resources.memoryMB,virtualCores:i.c.resources.virtualCores},driverResources:{memoryMB:i.c.resources.memoryMB,virtualCores:i.c.resources.virtualCores}}}),f}))}function m(e){var t=e.plugin,a=e.schema;return{name:t.name,plugin:{name:t.name,label:t.name,artifact:t.artifact,type:t.type,properties:l({},t.properties,{schema:JSON.stringify(a)})}}}},1774:function(e,t,a){var r=a(417),n=a(182),o=a(314);e.exports=function(e){return\"string\"==typeof e||!n(e)&&o(e)&&\"[object String]\"==r(e)}},2375:function(e,t,a){\"use strict\";a.r(t),a.d(t,\"default\",(function(){return B}));var r=a(1),n=a.n(r),o=a(0),i=a.n(o),s=a(4),c=a(9),l=a(16),u=a(8),p=a(3),m=a(2),f=a.n(m),d=a(6),g=a.n(d),y=a(31),b=a(119),h=a(1773),v=a(1774),w=a.n(v),E=a(12),O=a(24);function k(e){return(k=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function j(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=S(e);if(t){var n=S(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return C(this,a)}}function C(e,t){return!t||\"object\"!==k(t)&&\"function\"!=typeof t?function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M=\"features.DataPrep.TopPanel\",B=function(e){!function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(o,e);var t,a,r,n=N(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,o),(t=n.call(this,e)).state={loading:!0,batchUrl:null,realtimeUrl:null,error:null,workspaceId:null,realtimeConfig:null,batchConfig:null},t}return t=o,(a=[{key:\"componentWillMount\",value:function(){this.generateLinks()}},{key:\"generateLinks\",value:function(){var e=this,t=c.a.getState().dataprep.workspaceId,a=Object(u.d)();Object(h.a)().subscribe((function(r){var n;n=r.realtimeConfig?window.getHydratorUrl({stateName:\"hydrator.create\",stateParams:{namespace:a,workspaceId:t,artifactType:\"cdap-data-streams\"}}):null;var o=window.getHydratorUrl({stateName:\"hydrator.create\",stateParams:{namespace:a,workspaceId:t,artifactType:\"cdap-data-pipeline\"}});e.setState({loading:!1,realtimeUrl:n,batchUrl:o,workspaceId:t,realtimeConfig:r.realtimeConfig,batchConfig:r.batchConfig})}),(function(t){var a=function(e){if(-1!==e.indexOf(\"invalid field name\")){var t=e.split(\"field name: \"),a=Object(p.E)(t,1)||e;return{message:f.a.translate(\"\".concat(M,\".invalidFieldNameMessage\"),{fieldName:a}),remedies:\"\".concat(f.a.translate(\"\".concat(M,\".invalidFieldNameRemedies1\")))}}return{message:e}}(t),r=a.message,n=a.remedies,o=void 0===n?null:n;o?e.setState({error:{message:r,remedies:o},loading:!1}):e.setState({error:t,loading:!1})}))}},{key:\"applyDirective\",value:function(e){var t=this;Object(y.a)([e]).subscribe((function(){t.setState({error:null,loading:!0,schema:[]},(function(){t.generateLinks()}))}),(function(e){console.log(\"Error\",e),c.a.dispatch({type:l.a.setError,payload:{message:e.message||e.response.message}})}))}},{key:\"renderInvalidFieldError\",value:function(){return i.a.createElement(\"div\",{className:\"message\"},i.a.createElement(\"pre\",null,i.a.createElement(\"div\",{className:\"remedy-message\"},Object(p.E)(this.state,\"error\",\"remedies\")?this.state.error.remedies:null),i.a.createElement(\"span\",null,f.a.translate(\"\".concat(M,\".invalidFieldNameRemedies2\")),i.a.createElement(\"span\",{className:\"btn-link\",onClick:this.applyDirective.bind(this,\"cleanse-column-names\")},f.a.translate(\"\".concat(M,\".cleanseLinkLabel\"))),f.a.translate(\"\".concat(M,\".invalidFieldNameRemedies3\")))))}},{key:\"render\",value:function(){var e,t=this,a=!1===O.a.showRealtimePipeline;if(this.state.loading)e=i.a.createElement(\"div\",{className:\"loading-container\"},i.a.createElement(\"h4\",{className:\"text-center\"},i.a.createElement(\"span\",{className:\"fa fa-spin fa-spinner\"})));else{var r,n=c.a.getState().dataprep.workspaceInfo.properties.connection;this.state.realtimeUrl||(r=f.a.translate(\"\".concat(M,\".realtimeDisabledTooltip\"),{type:f.a.translate(\"\".concat(M,\".\").concat(n))}));var o=a?null:this.state.realtimeUrl;e=i.a.createElement(\"div\",null,i.a.createElement(\"div\",{className:\"message\"},f.a.translate(\"\".concat(M,\".addToPipelineModal.title\"))),i.a.createElement(\"div\",{className:\"action-buttons\"},i.a.createElement(\"a\",{href:this.state.error?null:this.state.batchUrl,className:g()(\"btn btn-secondary\",{inactive:this.state.error}),onClick:function(){t.state.error||window.localStorage.setItem(t.state.workspaceId,JSON.stringify(t.state.batchConfig))}.bind(this)},i.a.createElement(\"i\",{className:\"fa icon-ETLBatch\"}),i.a.createElement(\"span\",null,f.a.translate(\"\".concat(M,\".addToPipelineModal.batchPipelineBtn\")))),i.a.createElement(\"a\",{href:o,className:g()(\"btn btn-secondary\",{inactive:!this.state.realtimeUrl||this.state.error||a}),onClick:function(){t.state.realtimeUrl&&!a&&window.localStorage.setItem(t.state.workspaceId,JSON.stringify(t.state.realtimeConfig))}.bind(this),title:r},i.a.createElement(\"i\",{className:\"fa icon-sparkstreaming\"}),i.a.createElement(\"span\",null,f.a.translate(\"\".concat(M,\".addToPipelineModal.realtimePipelineBtn\"))))))}var l=!Object(p.E)(this.state,\"error\",\"remedies\");return i.a.createElement(s.Modal,{isOpen:!0,toggle:this.props.toggle,size:\"lg\",zIndex:1061,className:\"add-to-pipeline-dataprep-modal cdap-modal\"},i.a.createElement(s.ModalHeader,null,i.a.createElement(\"span\",null,f.a.translate(\"\".concat(M,\".addToPipelineBtnLabel\"))),i.a.createElement(\"div\",{className:\"close-section float-right\",onClick:this.props.toggle},i.a.createElement(\"span\",{className:\"fa fa-times\"}))),i.a.createElement(s.ModalBody,null,l?e:this.renderInvalidFieldError()),i.a.createElement(E.a,{condition:this.state.error},i.a.createElement(b.b,{type:\"DANGER\",message:f.a.translate(\"\".concat(M,\".addToPipelineModal.errorTitle\")),extendedMessage:w()(this.state.error)?this.state.error:null})))}}])&&j(t.prototype,a),r&&j(t,r),o}(o.Component);B.propTypes={toggle:n.a.func}}}]);","extractedComments":[]}